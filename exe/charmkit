#!/usr/bin/env ruby

require "active_support/core_ext/string/inflections"

if ARGV.length > 1
  puts "To many arguments, should be one of 'install, config-changed, start, stop, upgrade-charm'"
  exit 1
end

hook_name = ARGV.pop

if File.exists?("./lib/#{hook_name}.rb")
  require "./lib/#{hook_name}"
else
  puts "Could not find hook in ./lib/#{hook_name}.rb"
  exit 1
end

# Perform the Hook's tasks
hook = Object.const_get(hook_name.classify).new

# Install hook is a special case as it should only be run once.
# So we handle our apt package installation here prior to any
# other method execution.
if hook.is_a? Install
  hook.install
end

hook.summon
